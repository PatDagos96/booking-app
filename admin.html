<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Pannello di Controllo - Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #343a40; padding: 20px; }
        .container { background-color: white; border-radius: 10px; padding: 30px; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>ðŸ”’ Pannello Amministratore</h2>
        <button onclick="caricaAppuntamenti()" class="btn btn-warning">ðŸ”„ Aggiorna Lista</button>
    </div>

    <table class="table table-striped" id="tabellaAppuntamenti">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Cliente</th>
                <th>Servizio</th>
                <th>Data</th>
                <th>Ora</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody>
            </tbody>
    </table>
</div>

<script>
    async function caricaAppuntamenti() {
        const response = await fetch('/lista_appuntamenti');
        const dati = await response.json();
        const tbody = document.querySelector('#tabellaAppuntamenti tbody');
        tbody.innerHTML = '';
        
        dati.forEach(app => {
            tbody.innerHTML += `<tr>
                <td>${app.id}</td>
                <td><strong>${app.cliente}</strong></td>
                <td>${app.servizio}</td>
                <td>${app.data}</td>
                <td>${app.ora}</td>
                <td>
                    <button onclick="eliminaPrenotazione(${app.id})" class="btn btn-danger btn-sm">Cancella</button>
                </td>
            </tr>`;
        });
    }

    async function eliminaPrenotazione(id) {
        if (confirm("Sei sicuro di voler eliminare questa prenotazione?")) {
            await fetch(`/cancella/${id}`, { method: 'DELETE' });
            caricaAppuntamenti();
        }
    }

    // Carica subito i dati
    caricaAppuntamenti();
</script>
</body>
</html>